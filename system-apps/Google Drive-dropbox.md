How to design global file sharing and storage apps like Google Drive or Dropbox?

These are used to store and share files, photos, and other media. How do you go about designing things like allowing users to upload/view/search/share files or photos, track permissions for file sharing, and allow multiple users to edit the same document?
